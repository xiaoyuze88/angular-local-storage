/**
 * An Angular module that gives you access to the browsers local storage
 * @version v0.2.7 - 2016-04-06
 * @link https://github.com/grevory/angular-local-storage
 * @author grevory <greg@gregpike.ca>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,b){var c=b.isDefined,d=b.isUndefined,e=b.isNumber,f=b.isObject,g=b.isArray,h=b.extend,i=b.toJson,j=864e5,k=function(a){var b=Object.prototype.toString.call(a).toLowerCase();return"[object string],[object undefined],[object null],[object number],[object boolean]".split(",").some(function(a){return a==b})};b.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.expiryPrefix="__expiry",this.storageType="localStorage",this.expiry={value:72e5,alwaysExpire:!1},this.cookie={path:"/"},this.notify={setItem:!0,removeItem:!1},this.setOptions=function(a){},this.setExpiry=function(a,b){this.expiry.value=a,b&&(this.expiry.prefix=b)},this.setPrefix=function(a){return this.prefix=a,this},this.setStorageType=function(a){return this.storageType=a,this},this.setStorageCookie=function(a,b){return a&&(console.warn("Set expiry for cookie is deprecated, use setExpiry instead."),this.expiry.value=a*j),this.cookie.path=b,this},this.setStorageCookieDomain=function(a){return this.cookie.domain=a,this},this.setNotify=function(a,b){return this.notify={setItem:a,removeItem:b},this},this.$get=["$rootScope","$window","$document","$parse",function(a,b,l,m){var n,o=this,p=o.prefix,q=o.cookie,r=(o.expiry,o.notify),s=o.storageType;l?l[0]&&(l=l[0]):l=document,"."!==p.substr(-1)&&(p=p?p+".":"");var t=function(a){return p+a},u=function(){try{var c=s in b&&null!==b[s],d=t("__"+Math.round(1e7*Math.random()));return c&&(n=b[s],n.setItem(d,""),n.removeItem(d)),c}catch(e){return s="cookie",a.$broadcast("LocalStorageModule.notification.error",e.message),!1}}(),v=function(b,c,f,g){var h=0;if(d(c)?c=null:((o.expiry.alwaysExpire||f)&&(c={value:c},f=g||(e(f)&&f>0?f:o.expiry.value),h=f/j,c[o.expiryPrefix]=Date.now()+f),c=i(c)),!u||"cookie"===o.storageType)return u||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),r.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:"cookie"}),B(b,c,h);try{n&&n.setItem(t(b),c),r.setItem&&a.$broadcast("LocalStorageModule.notification.setitem",{key:b,newvalue:c,storageType:o.storageType})}catch(k){return a.$broadcast("LocalStorageModule.notification.error",k.message),B(b,c,h)}return!0},w=function(b,c){if(!u||"cookie"===o.storageType)return u||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),C(b);var d=n?n.getItem(t(b)):null;if(!d||"null"===d)return null;try{return d=JSON.parse(d),k(d)?c?(v(b,d,c),d):d:("__ts"in d&&v(b,d.value,!0,d.__ts),o.expiryPrefix in d?Date.now()-d[o.expiryPrefix]>0?void n.removeItem(t(b)):d.value:d)}catch(e){return d}},x=function(){var b,c;for(b=0;b<arguments.length;b++)if(c=arguments[b],u&&"cookie"!==o.storageType)try{n.removeItem(t(c)),r.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:o.storageType})}catch(d){a.$broadcast("LocalStorageModule.notification.error",d.message),D(c)}else u||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),r.removeItem&&a.$broadcast("LocalStorageModule.notification.removeitem",{key:c,storageType:"cookie"}),D(c)},y=function(){if(!u)return a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),[];var b=p.length,c=[];for(var d in n)if(d.substr(0,b)===p)try{c.push(d.substr(b))}catch(e){return a.$broadcast("LocalStorageModule.notification.error",e.Description),[]}return c},z=function(b){var c=p?new RegExp("^"+p):new RegExp,d=b?new RegExp(b):new RegExp;if(!u||"cookie"===o.storageType)return u||a.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),E();var e=p.length;for(var f in n)if(c.test(f)&&d.test(f.substr(e)))try{x(f.substr(e))}catch(g){return a.$broadcast("LocalStorageModule.notification.error",g.message),E()}return!0},A=function(){try{return b.navigator.cookieEnabled||"cookie"in l&&(l.cookie.length>0||(l.cookie="test").indexOf.call(l.cookie,"test")>-1)}catch(c){return a.$broadcast("LocalStorageModule.notification.error",c.message),!1}}(),B=function(b,c,h){if(d(c))return!1;if((g(c)||f(c))&&(c=i(c)),!A)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var k="",m=new Date,n="";if(null===c?(m.setTime(m.getTime()+-1*j),k="; expires="+m.toGMTString(),c=""):e(h)&&0!==h?(m.setTime(m.getTime()+h*j),k="; expires="+m.toGMTString()):0!==k.value&&(m.setTime(m.getTime()+k.value),k="; expires="+m.toGMTString()),b){var o="; path="+q.path;q.domain&&(n="; domain="+q.domain),l.cookie=t(b)+"="+encodeURIComponent(c)+k+o+n}}catch(p){return a.$broadcast("LocalStorageModule.notification.error",p.message),!1}return!0},C=function(b){if(!A)return a.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var c=l.cookie&&l.cookie.split(";")||[],d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(t(b)+"=")){var f=decodeURIComponent(e.substring(p.length+b.length+1,e.length));try{return JSON.parse(f)}catch(g){return f}}}return null},D=function(a){B(a,null)},E=function(){for(var a=null,b=p.length,c=l.cookie.split(";"),d=0;d<c.length;d++){for(a=c[d];" "===a.charAt(0);)a=a.substring(1,a.length);var e=a.substring(b,a.indexOf("="));D(e)}},F=function(){return s},G=function(a,b,d,e){e=e||b;var g=w(e);return null===g&&c(d)?g=d:f(g)&&f(d)&&(g=h(g,d)),m(b).assign(a,g),a.$watch(b,function(a){v(e,a)},f(a[b]))},H=function(){for(var a=0,c=b[s],d=0;d<c.length;d++)0===c.key(d).indexOf(p)&&a++;return a};return{isSupported:u,getStorageType:F,set:v,add:v,get:w,keys:y,remove:x,clearAll:z,bind:G,deriveKey:t,length:H,cookie:{isSupported:A,set:B,add:B,get:C,remove:D,clearAll:E}}}]})}(window,window.angular);
//# sourceMappingURL=angular-local-storage.min.js.map